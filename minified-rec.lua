local a=nil;local b=workspace.Configuration.Wave;b:GetPropertyChangedSignal("Value"):Connect(function()if b.Value>0 then if b.Value==1 then a=workspace:GetServerTimeNow()end end end)local function c(d,e)if d and d.Parent then table.insert(e,d.Parent==game and"game"or d.Parent.Name)c(d.Parent,e)end end;local function f(d,g)local e={d.Name}c(d,e)local h=e[#e]if g then for i=#e-1,1,-1 do h=h..":WaitForChild(\""..e[i].."\")"end else for i=#e-1,1,-1 do local j=e[i]if j:match("[^%w_]+")or j:sub(1,1):match("%d")then h=h.."[\""..j.."\"]"else h=h.."."..j end end end;return h end;function getPriceofCombo(k,l)if not l then return game.ReplicatedStorage.Characters[k].Stats.UsageCost.Value end;return game.ReplicatedStorage.Guns[l].Stats.UsageCost.Value+game.ReplicatedStorage.Characters[k].Stats.UsageCost.Value end;function getPriceOfUpgrade(k,m)return k.Upgrades[m][k.UpgradeLevels[m].Value+1]:GetChildren()[1].UsageCost.Value end;function getCurrentTime()return math.floor((workspace:GetServerTimeNow()-a)*100)/100 end;function getTrueTowers()local n={}for g,o in pairs(workspace.Map.Towers:GetChildren())do if o.Name~="Mine"then table.insert(n,o)end end;return n end;local p={["Stronger Enemies"]="EnemyHealth",["Panic Mode"]="OneHealth",["Hyperinflation"]="TowerCost",["Social Distancing"]="Distancing",["Ghostified Enemies"]="Camouflage",["Stun Madness"]="TrueStunMadness",["Regeneration"]="Regeneration",["Low Supply"]="LowTowerLimit",["Impossible"]="Impossible",["Speedrun"]="Speedrun",["Less Gadgets"]="LessGadgets",["No Refund"]="NoRefund",["Bad Connection"]="BadConnection",["More Firepower, More Gain"]="NoTowerSpam",["Halved Budget"]="HalvedCash",["Gun Shortage"]="GunLimit",["Sandbox"]="Sandbox",["Hellspeed"]="Hellspeed",["Mega Stuns"]="MegaStuns",["Sabotaged Gadgets"]="SabotagedGadgets",["Normal"]="Normal"}writefile("recorded_pgtd.lua","local pgtd = loadstring(game:HttpGet(\"https://raw.githubusercontent.com/usamiername/pgtd-replayer/main/minified.lua\"))()\npgtd.set(\""..workspace.Configuration.MapName.Value.."\", "..tostring(workspace.Difficulty.Value)..", {")for o in string.gmatch(workspace.Configuration.ModifierNames.Value,"[^/]+")do appendfile("recorded_pgtd.lua","\""..p[o].."\",")end;appendfile("recorded_pgtd.lua","})\n")local q=getrawmetatable(game)local r=q.__namecall;setreadonly(q,false)q.__namecall=newcclosure(function(self,...)local s=getnamecallmethod()local t={...}s=tostring(s)if s=="FireServer"and tostring(self)=="PlaceTower"then spawn(function()for g,o in pairs(workspace.Map:GetDescendants())do if o==t[5]then if t[2]then if game.Players.LocalPlayer.Cash.Value>=getPriceofCombo(t[2],t[3])then if workspace.Configuration.Wave.Value==0 then for u,v in pairs(o.Parent:GetChildren())do if o==v then appendfile("recorded_pgtd.lua","pgtd.placeTower(\""..tostring(t[2]).."\", \""..tostring(t[3]).."\", Vector3.new("..tostring(t[1]).."), Vector3.new("..tostring(t[6]).."), "..f(o.Parent,false)..":GetChildren()["..tostring(u).."], 0)\n")end end else for u,v in pairs(o.Parent:GetChildren())do if o==v then appendfile("recorded_pgtd.lua","pgtd.placeTower(\""..tostring(t[2]).."\", \""..tostring(t[3]).."\", Vector3.new("..tostring(t[1]).."), Vector3.new("..tostring(t[6]).."), "..f(o.Parent,false)..":GetChildren()["..tostring(u).."], "..getCurrentTime()..")\n")end end end end elseif not string.match(t[5]:GetFullName(),"AutoLandmineSpot")then if workspace.Configuration.Wave.Value==0 then for u,v in pairs(o.Parent:GetChildren())do if o==v then appendfile("recorded_pgtd.lua","pgtd.useAbility(\""..t[4].."\", Vector3.new("..tostring(t[1]).."), Vector3.new("..tostring(t[6]).."), "..f(o.Parent,false)..":GetChildren()["..tostring(u).."], 0)\n")end end else for u,v in pairs(o.Parent:GetChildren())do if o==v then appendfile("recorded_pgtd.lua","pgtd.useAbility(\""..t[4].."\", Vector3.new("..tostring(t[1]).."), Vector3.new("..tostring(t[6]).."), "..f(o.Parent,false)..":GetChildren()["..tostring(u).."], "..getCurrentTime()..")\n")end end end end;break end end end)elseif s=="FireServer"and tostring(self)=="Action"then spawn(function()if t[1]=="Upgrade"then for g,o in pairs(getTrueTowers())do if self.Parent==o then if game.Players.LocalPlayer.Cash.Value>=getPriceOfUpgrade(self.Parent,t[2])then if workspace.Configuration.Wave.Value==0 then appendfile("recorded_pgtd.lua","pgtd.upgradeTower("..tostring(g)..", \""..t[2].."\",  0)\n")else appendfile("recorded_pgtd.lua","pgtd.upgradeTower("..tostring(g)..", \""..t[2].."\", "..getCurrentTime()..")\n")end end end end elseif t[1]=="Sell"then for g,o in pairs(getTrueTowers())do if self.Parent==o then if workspace.Configuration.Wave.Value==0 then appendfile("recorded_pgtd.lua","pgtd.sellTower("..tostring(g)..",  0)\n")else appendfile("recorded_pgtd.lua","pgtd.sellTower("..tostring(g)..", "..getCurrentTime()..")\n")end end end elseif t[1]=="Targetting"then for g,o in pairs(getTrueTowers())do if self.Parent==o then if workspace.Configuration.Wave.Value==0 then appendfile("recorded_pgtd.lua","pgtd.changeTarget("..tostring(g)..", "..t[2]..",  0)\n")else appendfile("recorded_pgtd.lua","pgtd.changeTarget("..tostring(g)..", \""..t[2].."\", "..getCurrentTime()..")\n")end end end end end)end;return r(self,unpack(t))end)setreadonly(q,true)
